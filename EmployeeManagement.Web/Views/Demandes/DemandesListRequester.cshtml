@model IEnumerable<StockManagement.Application.Features.Demandes.DTOs.GetListDemandesByUserIdResponseDTO>

<head>
    <link rel="stylesheet" href="~/css/DemandesListRequester.css">
</head>

<div class="demandes-list-container">
    <h1 class="page-title">Liste des Demandes</h1>

    <!-- Boutons de connexion et déconnexion -->
    <div class="auth-buttons mb-4">
        <a href="/api/Employees/Login" class="btn btn-outline-secondary">Se connecter</a>
        <form method="post" action="/api/Employees/Logout" class="d-inline">
            <button type="submit" class="btn btn-outline-secondary">Se déconnecter</button>
        </form>
        <a href="/api/Employees/Register" class="btn btn-primary">Créer un compte</a>
    </div>

    <!-- Boutons d'exportation -->
    <div class="action-buttons mb-4">
        <a href="/api/Demandes/export" class="btn btn-success">Exporter vers Excel</a>
        <a href="/api/Demandes/export/pdf" class="btn btn-danger">Exporter vers PDF</a>
    </div>

    <!-- Tableau des demandes -->
    <table class="table table-striped table-hover">
        <thead class="table-header">
            <tr>
                <th>ID</th>
                <th>Nom</th>
                <th>Prénom</th>
                <th>Direction</th>
                <th>Division</th>
                <th>Service</th>
                <th>Status</th>
                <th>Produits</th>
            </tr>
        </thead>
        <tbody>
            @if (Model != null && Model.Any())
            {
                foreach (var demande in Model)
                {
                    <tr>
                        <td>@demande.Id</td>
                        <td>@demande.Nom</td>
                        <td>@demande.Prenom</td>
                        <td>@demande.DirectionNom</td>
                        <td>@demande.DivisionNom</td>
                        <td>@demande.ServiceNom</td>
                        <td class="@(demande.StatusDemandeNom == "En cours de traitement" ? "status-en-cours" :
                                 demande.StatusDemandeNom == "Validé" ? "status-valide" :
                                 demande.StatusDemandeNom == "Annulé" ? "status-annule" :
                                 "status-rejete")">
                            @demande.StatusDemandeNom
                        </td>
                        <td>
                            <select class="form-control">
                                @foreach (var produit in demande.LstProduitQuantiteDTOs)
                                {
                                    <option value="@produit.ProduitNom">
                                        @produit.ProduitNom - Quantité: @produit.Quantité
                                    </option>
                                }
                            </select>
                        </td>
                    </tr>
                }
            }
            else
            {
                <tr>
                    <td colspan="8" class="text-center">Aucune demande trouvée.</td>
                </tr>
            }
        </tbody>
    </table>

</div>

